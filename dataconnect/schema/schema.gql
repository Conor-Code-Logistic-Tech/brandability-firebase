# Defines the data models for the LegalTech Predictor application.
# This schema is the single source of truth for all data structures,
# derived from the master JSON schema and refined through case law analysis.

# -------------------
# ENUMS
# -------------------

"""The legal jurisdiction of the decision."""
enum Jurisdiction {
  UKIPO
  EUIPO
}

"""The type of a trademark."""
enum MarkType {
  WORD
  FIGURATIVE
  WORD_AND_DEVICE
  THREE_DIMENSIONAL
}

"""The outcome of a proof of use assessment."""
enum ProofOfUseOutcome {
  use_proven
  use_not_proven
  not_applicable
}

"""The degree of similarity between goods and services."""
enum SimilarityDegree {
  identical
  high_degree
  medium_degree
  low_degree
  dissimilar
}

"""The degree of conceptual similarity between trademarks."""
enum ConceptualSimilarityDegree {
  identical
  high_degree
  medium_degree
  low_degree
  dissimilar
  neutral
}

"""The inherent distinctive character of the earlier mark."""
enum DistinctiveCharacter {
  very_high_degree
  high_degree
  medium_degree
  low_degree
}

"""The level of attention of the average consumer."""
enum AverageConsumerAttention {
  high
  medium
  low
}

"""The type of confusion found between marks."""
enum ConfusionType {
  direct
  indirect
  both
}

"""The final outcome of the opposition case."""
enum OppositionOutcome {
  successful
  partially_successful
  unsuccessful
}

enum OtherGrounds {
  FIVE_THREE
  FIVE_FOUR_A
}


# -------------------
# DATA MODELS (Firestore Collections)
# -------------------

"""
A structured representation of a trademark opposition case decision.
This is the main document stored in the 'cases' collection.
"""
type Case @table(name: "cases", key: "id") {
  id: String! @col(name: "caseReference")
  decisionDate: Date
  decisionMaker: String
  jurisdiction: Jurisdiction
  applicationNumber: String!
  applicantName: String!
  opponentName: String!
  groundsForOpposition: [String!]!
  proofOfUseRequested: Boolean!
  proofOfUseOutcome: ProofOfUseOutcome
  distinctiveCharacter: DistinctiveCharacter!
  averageConsumerAttention: AverageConsumerAttention!
  likelihoodOfConfusion: Boolean!
  confusionType: ConfusionType
  oppositionOutcome: OppositionOutcome
  otherGrounds: [OtherGrounds]
  globalAssessmentNotes: String
}

"""
A mark the applicant is trying to register.
"""
type ApplicantMark @table(name: "applicantMarks", key: "id") {
  id: String!
  mark: String!
  markType: MarkType!
  case: Case!
}

"""
An earlier mark the opponent is relying on.
"""
type OpponentMark @table(name: "opponentMarks", key: "id") {
  id: String!
  mark: String!
  markType: MarkType
  registrationNumber: String
  filingDate: Date
  registrationDate: Date
  priorityDate: Date
  case: Case!
}

"""
Represents the goods and services for a specific class.
"""
type GoodsServices @table(name: "goodsServices", key: "id") {
  id: String!
  classNum: Int! @col(name: "class")
  terms: [String!]!
  applicantMark: ApplicantMark
  opponentMark: OpponentMark
}

"""
Comparison between a specific applicant and opponent G&S term.
"""
type GoodsServicesComparison @table(name: "goodsServicesComparisons", key: "id") {
  id: String!
  applicantTerm: String!
  opponentTerm: String!
  similarity: SimilarityDegree!
  case: Case!
}

"""
Comparison of the marks on visual, aural, and conceptual levels.
"""
type MarkComparison @table(name: "markComparisons", key: "id") {
  id: String!
  visualSimilarity: SimilarityDegree!
  auralSimilarity: SimilarityDegree!
  conceptualSimilarity: ConceptualSimilarityDegree!
  dominantComponent: String
  case: Case!
}

"""
Rationale behind the decision, including key factors and cited precedents.
"""
type DecisionRationale @table(name: "decisionRationales", key: "id") {
  id: String!
  keyFactors: [String!]!
  case: Case!
}

"""
A precedent case cited in the decision.
"""
type Precedent @table(name: "precedents", key: "id") {
  id: String!
  caseName: String!
  caseReference: String!
  summary: String
  relevanceScore: Float
  decisionRationale: DecisionRationale!
}
